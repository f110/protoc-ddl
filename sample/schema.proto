syntax = "proto3";
package sample;
option go_package = "github.com/f110/protoc-gen-ddl/sample;sample";

import "ddl.proto";
import "google/protobuf/timestamp.proto";

message User {
    int32 id  = 1 [(dev.f110.ddl.column) = {sequence: true}];
    int32 age = 2 [(dev.f110.ddl.column) = {default: "20"}];
    google.protobuf.Timestamp created_at = 3;

    option (dev.f110.ddl.table) = {
        table_name: "users",
        primary_key: "id",
    };
}

message Blog {
    int64  id          = 1 [(dev.f110.ddl.column) = {sequence: true}];
    User   user        = 2;
    string title       = 3 [(dev.f110.ddl.column) = {size: 100}];
    string body        = 4 [(dev.f110.ddl.column) = {type: "text"}];
    int32  category_id = 5;
    bytes  attach      = 6 [(dev.f110.ddl.column) = {type: "long"}];

    option (dev.f110.ddl.table) = {
        primary_key: "id",
        indexes: {
            name: "idx_user_id_and_id"
            columns: "user_id"
            columns: "id"
            unique: true
        };
        indexes: {
            columns: "user_id"
            columns: "category_id"
        };
    };
}

message Comment {
    Blog blog = 1;
    User user = 2;

    option (dev.f110.ddl.table) = {
        primary_key: "blog_id"
        primary_key: "user_id"
    };
}

message Like {
    uint64 id = 1 [(dev.f110.ddl.column) = {sequence: true}];
    User user = 2;
    Blog blog = 3;

    option (dev.f110.ddl.table) = {
        primary_key: "id"
    };
}